<!DOCTYPE html>
<html>
  <head>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  </head>
  <body>
    <input type="file" id="fileInput" accept=".csv" />
    <input type="text" id="startWord" placeholder="Palabra de inicio" />
    <button onclick="drawChart()">Generar &Aacute;rbol de Palabras</button>
    <div id="wordtree_basic" style="width: 1200px; height: 800px;"></div>
    
    <script>
      google.charts.load("current", { packages: ["wordtree"] });

      function drawChart() {
        var fileInput = document.getElementById('fileInput');
        var startWord = document.getElementById('startWord').value;

        if (fileInput.files.length === 0) {
          alert("Por favor selecciona un archivo CSV.");
          return;
        }

        if (!startWord) {
          alert("Por favor ingresa una palabra de inicio.");
          return;
        }

        Papa.parse(fileInput.files[0], {
          complete: function(results) {
            var csvData = [['ID', 'Parent', 'Child']];
            var idCounter = 0;
            results.data.forEach(row => {
              var phrase = row[0];
              var words = phrase.split(' ');
              var parentIndex = null;
              for (var i = 0; i < words.length; i++) {
                var currentWord = words[i];
                csvData.push([idCounter, parentIndex, currentWord]);
                parentIndex = idCounter;
                idCounter++;
              }
            });
            
            try {
              var data = google.visualization.arrayToDataTable(csvData);
              
              var options = {
                wordtree: {
                  format: "explicit" // Utilizando el formato 'explicit'
                },
              };

              var chart = new google.visualization.WordTree(document.getElementById("wordtree_basic"));
              chart.draw(data, options);
            } catch (error) {
              console.error("Error al dibujar el Ã¡rbol de palabras:", error);
            }
          }
        });
      }
    </script>
  </body>
</html>
